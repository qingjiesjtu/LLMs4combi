{
  "1.13": {
    "problem": "考虑平面上的一个任意凸$n$边形（$n \\geq 6$）： % \\begin{enumerate}[label={\\rm (\\arabic*)}] \\item 作$2$条不同的对角线，要求它们仅有一个位于多边形顶点处的公共点，求方案数； \\item 作$2$条不同的对角线，要求它们无公共点，求方案数。 \\end{enumerate}",
    "answers": {
      "(1)": [
        {
          "answer": "\\item 选定多边形上一点，从这点出发作两条对角线，除去与这点相邻的两个顶点外，共有$n - 3$个顶点可选，因此方案数为$n \\binom{n - 3}{2}$；",
          "rules": [
            {
              "rule": "选中任意一点作为公共点",
              "score": 1
            },
            {
              "rule": "剩下的选两个",
              "score": 2
            },
            {
              "rule": "答案正确",
              "score": 1
            }
          ]
        }
      ],
      "(2)": [
        {
          "answer": "\\item 多边形对角线共有$\\binom{n}{2} - n$条，从中选出两条共有$\\binom{\\binom{n}{2} - n}{2}$种方案。 若这两条对角线有公共点，则或者在顶点上，或者在多边形内部；公共点在顶点上的方案数已在第(1)问种求出。 若公共点在内部，则两条对角线即为其四个顶点所确定的四边形的两条对角线，方案数为$\\binom{n}{4}$。 综上，总方案数为 % \\begin{align*} & \\binom{\\binom{n}{2} - n}{2} - n \\binom{n - 3}{2} - \\binom{n}{4} \\\\ & = \\frac{1}{8} ( n^2 - 3n ) ( n^2 - 3n - 2 ) - \\frac{1}{2} n (n - 3) (n - 4) - \\frac{1}{24} n (n - 1) (n - 2) (n - 3) \\\\ & = \\frac{n (n - 3)}{24} \\left[ 3(n^2 - 3n - 2) - 12(n - 4) - (n - 1)(n - 2) \\right] \\\\ & = \\frac{n (n - 3)}{24} \\left( 2n^2 - 18n + 40 \\right) \\\\ & = \\frac{n (n - 3) (n - 4) (n - 5)}{12} = \\frac{n}{2} \\binom{n - 3}{3} \\end{align*}",
          "rules": [
            {
              "rule": "对角线数量正确",
              "score": 1
            },
            {
              "rule": "任取两条对角线数量正确",
              "score": 1
            },
            {
              "rule": "公共顶点数量正确",
              "score": 1
            },
            {
              "rule": "与答案等价",
              "score": 1
            },
            {
              "rule": "结果化简",
              "score": 1
            }
          ]
        }
      ]
    }
  },
  "1.14": {
    "problem": "\\begin{exercise} 设$\\left\\{ a_i \\right\\}$是一长度为$60$的正整数列（$1 \\leq i \\leq 60$），其中$a_1 = 1, a_{60}=20^{20}$，并且数列中每一项都是其后面一项的约数。 % \\begin{enumerate}[label={\\rm (\\arabic*)}] \\item 求满足要求的数列$\\left\\{ a_i \\right\\}$的数目； \\item 若进一步要求$\\left\\{ a_i \\right\\}$严格递增，求满足条件的序列数目。 \\end{enumerate} \\end{exercise}",
    "answers": {
      "(1)": [
        {
          "answer": "$20^{20} = 2^{40} \\dotp 5^{20}$。 \\begin{enumerate}[label={\\rm (\\arabic*)}] \\item 每一项中含有$2$的幂次和$5$的幂次分别单调递增。 以$2$的幂次为例，可想象成是走$58 \\times 40$的格路，路径在$x = i - 2$处的最大$y$坐标即为$a_i$中$2$的幂次；对于$5$也类似。 总的方案数为$\\binom{98}{40} \\binom{78}{20}$；",
          "rules": [
            {
              "rule": "分解$20^{20}$",
              "score": 1
            },
            {
              "rule": "答案正确",
              "score": 3
            }
          ]
        }
      ],
      "(2)": [
        {
          "answer": "\\item 讨论数列$\\left\\{ \\frac{a_{i+1}}{a_i} \\right\\}$（$1 \\leq i \\leq 59$），该数列的组成有三种情况： % \\begin{itemize} \\item $38$个$2$、$20$个$5$、$1$个$4$，有$59 \\binom{58}{20}$种情况； \\item $39$个$2$、$19$个$5$、$1$个$10$，有$59 \\binom{58}{19}$种情况； \\item $40$个$2$、$18$个$5$、$1$个$25$，有$59 \\binom{58}{18}$种情况。 \\end{itemize} % 因此，总共有$59 \\left[ \\binom{58}{18} + \\binom{58}{19} + \\binom{58}{20} \\right]$种情况。",
          "rules": [
            {
              "rule": "讨论数列形式",
              "score": 1
            },
            {
              "rule": "情况1正确",
              "score": 1
            },
            {
              "rule": "情况2正确",
              "score": 1
            },
            {
              "rule": "情况3正确",
              "score": 1
            },
            {
              "rule": "答案正确",
              "score": 1
            }
          ]
        }
      ]
    }
  },
  "1.15": {
    "problem": "现有$23$个不同的物体，将其放入$25$个不同的箱子，每个箱子中至多放入一个物体，且禁止出现相邻的空箱子，求方案数。",
    "answers": {
      "(1)": [
        {
          "answer": "共有$\\binom{24}{2}$种方案选择两个不相邻的空箱子，然后排列所有物体，方案数为$\\binom{24}{2} \\dotp 23! = \\frac{23 \\dotp 24!}{2}$。",
          "rules": [
            {
              "rule": "得到正确的不相邻方案数",
              "score": 4
            },
            {
              "rule": "考虑物体的排列",
              "score": 2
            },
            {
              "rule": "答案正确",
              "score": 4
            }
          ]
        }
      ]
    }
  },
  "1.16": {
    "problem": "直线分圆是一个非常有趣的组合数学问题，考虑下列直线分圆问题： % \\begin{enumerate}[label={\\rm (\\arabic*)}] \\item 在平面上作一个圆和$n$条直线，求这些直线最多将圆分为多少个部分； \\item 在平面上作一个圆并在圆周上任取$n$个点，这些点两两连线得到一系列圆内的线段，假设任意三条线段不共点，求这些线段在圆内的交点数目； \\item 在第(2)问的基础上，考察所有三边均在这些线段上的三角形，这些三角形可能有$0$个、$1$个、$2$个或$3$个顶点在圆上，求每种三角形的数目； \\item 在第(2)问的基础上，求这些线段将圆分为多少个部分（\\textit{提示：利用欧拉公式，即平面图的顶点数$V$、边数$E$和面数$F$之间满足关系$V + F - E = 1$}）。 \\end{enumerate}",
    "answers": {
      "(1)": [
        {
          "answer": "\\item 依次画出每一条直线，第$i$条直线被之前的直线分为$i$段，每段均将一个原本的区域一分为二，因此总区域数为$1 + \\sum_{i = 1}^n i = \\frac{n^2 + n + 2}{2}$；",
          "rules": [
            {
              "rule": "每条直线增加区域数量正确",
              "score": 1
            },
            {
              "rule": "答案正确",
              "score": 1
            }
          ]
        }
      ],
      "(2)": [
        {
          "answer": "\\item 任取圆周上四点均可作一对交于一点的对角线（思路与习题1.13(2)类似），因此总交点数即为$\\binom{n}{4}$；",
          "rules": [
            {
              "rule": "答案正确",
              "score": 1
            }
          ]
        }
      ],
      "(3)": [
        {
          "answer": "\\item 分类讨论： % \\begin{itemize} \\item $0$个点在圆上：任取圆上六点，顺时针编号为$A, B, \\cdots, F$，则$AD, BE, CF$三条对角线恰能交出一个三顶点均不在圆上的三角形，因此方案数为$\\binom{n}{6}$； \\item $1$个点在圆上：任取圆上五点，顺时针编号为$A, B, \\cdots, E$，选定$A$为圆上一点（$B, \\cdots, E$同理）， 则$AC, AD, BE$三条对角线恰能交出一个$1$个顶点在圆上的三角形，因此方案数为$5\\binom{n}{5}$； \\item $2$个点在圆上：任取圆上四点，顺时针编号为$A, B, C, D$，设$AC, BD$交于$O$，则$AOB, BOC, COD, DOA$是四个有$2$个顶点在圆上的三角形，因此方案数为$4\\binom{n}{4}$； \\item $3$个点在圆上：方案数显然为$\\binom{n}{3}$。 \\end{itemize}",
          "rules": [
            {
              "rule": "3个顶点在圆上的情况正确",
              "score": 1
            },
            {
              "rule": "2个顶点在圆上的情况正确",
              "score": 1
            },
            {
              "rule": "1个顶点在圆上的情况正确",
              "score": 1
            },
            {
              "rule": "0个顶点在圆上的情况正确",
              "score": 1
            }
          ]
        }
      ],
      "(4)": [
        {
          "answer": "\\item 平面图的顶点数显然为$V = n + \\binom{n}{4}$。 平面图的边包含圆上$n$段，以及圆内$\\binom{n}{2}$条顶点连线，以及圆内每个交点将两条线段分别一分为二，因此$E = n + \\binom{n}{2} + 2\\binom{n}{4}$。 因此，$F = E - V + 1 = \\binom{n}{4} + \\binom{n}{2} + 1$。",
          "rules": [
            {
              "rule": "顶点数正确",
              "score": 1
            },
            {
              "rule": "边数正确",
              "score": 1
            },
            {
              "rule": "答案正确",
              "score": 1
            }
          ]
        }
      ]
    }
  },
  "1.17": {
    "problem": "完全二分图$K_{n, n}$指的是一个简单无向图$G = (V, E)$，其中点集$V = \\left\\{ 1, 2, \\cdots, 2n \\right\\}$，边集$E = \\left\\{ (i, n + j) \\mid 1 \\leq i, j \\leq n \\right\\}$。 图上的简单回路指的是不含重复顶点或重复边的回路。 设正整数$k$满足$1 \\leq k \\leq n$，求$K_{n, n}$上长度为$2k$的简单回路的数目。",
    "answers": {
      "(1)": [
        {
          "answer": "若$k = 1$，答案为$0$。 否则，从二分图的每个部分各选出$k$个点，然后将两组各$k$个点彼此间隔排成长度为$2k$的圆排列，最后注意到这样将每个回路一正一反计算了两次，因此答案为 % \\begin{equation*} \\frac{1}{2} \\dotp \\binom{n}{k}^2 \\dotp \\frac{(k)!}{k} = \\frac{(n!)^2}{2k \\left[ (n - k)! \\right]^2} \\end{equation*} % 由于题目可能有歧义，此答案乘上$2$（考虑方向）、$2k$（考虑起点）或$4k$（二者均考虑）也算对。",
          "rules": [
            {
              "rule": "k=1情况正确",
              "score": 1
            },
            {
              "rule": "二分图回路在两侧各有k个点",
              "score": 4
            },
            {
              "rule": "使用交错序列计数",
              "score": 4
            },
            {
              "rule": "答案正确",
              "score": 1
            }
          ]
        }
      ]
    }
  },
  "1.18": {
    "problem": "使用$1, 2, \\cdots, 9$构造一个$n$位正整数，使此数从高位到低位，每一位数都小于等于前一位数，求满足条件的整数数目。",
    "answers": {
      "(1)": [
        {
          "answer": "等价于$\\left\\{ 1, 2, \\cdots, 9 \\right\\}$的$n$-可重组合，方案数为$\\binom{n + 8}{n}$。",
          "rules": [
            {
              "rule": "发现题目的组合意义或列出不定方程",
              "score": 4
            },
            {
              "rule": "答案正确",
              "score": 6
            }
          ]
        }
      ]
    }
  },
  "1.19": {
    "problem": "现有甲、乙、丙三类物品各$2n$件，同类物品之间没有区别。 现要将它们分给两个人，要求每个人分得$3n$件物品，求共有多少种分法。",
    "answers": {
      "(1)": [
        {
          "answer": "等价于求$x + y + z = 3n$（$0 \\leq x, y, z \\leq 2n$）的非负整数解。 先不考虑限制条件，方案数为$\\binom{3n + 2}{2}$。 若$x, y, z$中任一变量不满足限制条件，不妨设为$x$，则设$x = 2n + 1 + x'$，于是有$x' + y + z = n - 1$，其非负整数解数目为$\\binom{n + 1}{2}$。 排除掉所有不满足限制条件的情况，最终答案即为 % \\begin{equation*} \\binom{3n + 2}{2} - 3 \\binom{n + 1}{2} = 3n^2 + 3n + 1 \\end{equation*}",
          "rules": [
            {
              "rule": "总方案数正确",
              "score": 4
            },
            {
              "rule": "不满足条件的方案数正确",
              "score": 4
            },
            {
              "rule": "答案正确",
              "score": 2
            }
          ]
        }
      ]
    }
  },
  "1.20": {
    "problem": "从字典$\\left\\{ c_1, c_2, \\cdots, c_D \\right\\}$中选出$n$个字符组成字符串，要求字符$c_i$出现次数为$f_i$，保证$\\sum_{i = 1}^D f_i = n$。 设非负整数$k$满足$k ( D + 1 ) > n$，求子串$c_1 c_2 ... c_D$的出现次数恰好为$k$的字符串的数目。",
    "answers": {
      "(1)": [
        {
          "answer": "若存在$f_i < k$，则方案数显然为$0$。 否则，先“打包”$k$个子串$c_1 c_2 \\cdots c_D$，然后在其中插入剩下的$n - kD$个字符。 安排剩下的字符位置的方案数为$\\binom{n - kD + k}{k}$，这些字符排列的方案数为$\\frac{(n - kD)!}{\\prod_{i = 1}^D (f_i - k)!}$，因此总的方案数即为 % \\begin{equation*} \\binom{n - kD + k}{k} \\frac{(n - kD)!}{\\prod_{i = 1}^D (f_i - k)!} = \\frac{(n - kD + k)!}{k! \\prod_{i = 1}^D (f_i - k)!} \\end{equation*}",
          "rules": [
            {
              "rule": "将$c_1 c_2 \\cdots c_D$打包成一个字符",
              "score": 4
            },
            {
              "rule": "剩下的字符位置方案数正确",
              "score": 2
            },
            {
              "rule": "剩下的字符排列方案数正确",
              "score": 2  
            },
            {
              "rule": "答案正确",
              "score": 2
            }
          ]
        }
      ]
    }
  },
  "1.21": {
    "problem": "某只“千足虫”有左右两侧各$100$只脚，假设它要为每只脚穿鞋子和袜子。 % \\begin{enumerate}[label={\\rm (\\arabic*)}] \\item 若要求穿所有袜子在所有鞋子之前，穿所有左脚袜子、鞋子分别在所有右脚袜子、鞋子之前，求穿鞋袜的方案数。 \\item 若要求穿每只脚袜子在每只脚鞋子之前，穿每一对脚中的左脚袜子、鞋子分别在右脚袜子、鞋子之前，求穿鞋袜的方案数。 \\end{enumerate}",
    "answers": {
      "(1)": [
        {
          "answer": "\\item 顺序必须为左脚袜子→右脚袜子→左脚鞋子→右脚鞋子，每种衣物内部脚的顺序可以任一排列，因此方案数即为$(100!)^4$；",
          "rules": [
            {
              "rule": "答案正确",
              "score": 5
            }
          ]
        }
      ],
      "(2)": [
        {
          "answer": "\\item 每一对脚有$4!$种穿袜子、鞋子顺序，但是其中仅有$2$种合法，因此在无任何约束情况下的的方案数$400!$要对每一对脚均除以$12$，结果即为$\\frac{400!}{12^{100}}$。",
          "rules": [
            {
              "rule": "答案正确",
              "score": 5
            }
          ]
        }
      ]
    }
  },
  "1.22": {
    "problem": "设$n$是正整数，非负整数$k$满足$2^k \\mid P(2n, n)$，求$k$的最大值。",
    "answers": {
      "(1)": [
        {
          "answer": "注意到 % \\begin{equation*} P(2n, n) = \\frac{(2n)!}{n!} = \\frac{\\left( \\prod_{j = 1}^n 2j \\right) \\prod_{j = 1}^n (2j - 1)}{n!} = \\frac{2^n \\dotp n! \\dotp \\prod_{j = 1}^n (2j - 1)}{n!} = 2^n \\prod_{j = 1}^n (2j - 1) \\end{equation*} % 因此显然有$k = n$。",
          "rules": [
            {
              "rule": "论证合理即可",
              "score": 10
            }
          ]
        }
      ]
    }
  },
  "1.23": {
    "problem": "设有一无穷正整数列$\\left\\{ a_1, a_2, a_3, \\cdots \\right\\}$，其中每一项均大于$1$。 以此数列定义一种进制：当第$n$位达到$a_n$时，向第$n + 1$位进一。 按此定义，二进制、十进制等即为常数列定义的进制，我们在讨论全排列生成算法时介绍的递增进位制即为基于等差数列定义的进制。 证明：任意正整数在此进制下的表示唯一。",
    "answers": {
      "(1)": [
        {
          "answer": "证明：设$1\\underbrace{00\\cdots0}_{k\\;\\mbox{\\footnotesize 个}\\;0}$表示的数字为$p_k$。 容易证明任意两个$k$位数之差的绝对值小于$p_k$。 现在假设某数在此进制下有$2$种不同的表示，设两种表示最高在第$k$位不同，则二者在这一位上至少相差$p_k$； 在更低位上二者需同样至少相差$p_k$才能使两种表示所代表的数字相等，然而根据之前的结论这是不可能的，从而导出矛盾。",
          "rules": [
            {
              "rule": "有反证法",
              "score": 1
            },
            {
              "rule": "找出不同的最高或最低位",
              "score": 4
            },
            {
              "rule": "说明其他位不可能补上两者之差",
              "score": 5
            }
          ]
        }
      ]
    }
  },
  "1.24": {
    "problem": "在正四面体的顶点和各棱中点这$10$个点（如右图所示）中选取$4$个，求使这$4$点不共面的方案数。",
    "answers": {
      "(1)": [
        {
          "answer": "任取四点有$\\binom{10}{4} = 210$种方案。 四点共四面体表面$4 \\binom{6}{4} = 60$种方案，四棱中点共面$3$种方案，一边三点与对边中点共面$6$种方案，合计$210 - 60 - 3 - 6 = 141$种方案。",
          "rules": [
            {
              "rule": "任取四点方案数正确",
              "score": 1
            },
            {
              "rule": "表面共面方案数正确",
              "score": 2
            },
            {
              "rule": "四棱中点共面方案数正确",
              "score": 3
            },
            {
              "rule": "一边三点与对棱中点共面方案数正确",
              "score": 3
            },
            {
              "rule": "答案正确",
              "score": 1
            }
          ]
        }
      ]
    }
  }
}