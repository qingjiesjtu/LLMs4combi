{
  "1.13": {
    "(1)": "\\item 首先选定公共点位置，共有 $ n $ 种选择。 然后再在与公共点不相邻的剩余 $ n-3 $ 个点中，选择两个点作为两条对角线的顶点，顺序无关，共有 $ C(n-3, 2) $ 种选择。 因此共有 $ n C(n-3, 2) $ 种选择。",
    "(2)": "\\item 首先从 $ n $ 个点中选出 $ 4 $ 个点，作为两条“对角线”的顶点，共有 $ C(n, 4) $ 种选择。 对于任意 $ 4 $ 个点，有 $ 2 $ 种方式连成不相交的连线。 但是，在上述方案中，包含了将凸多边形的边作为“对角线”的情况，需要刨除，使用容斥原理计算： 首先从多边形中选出 $ 1 $ 条边（$ n $ 种选择），再在剩余 $ n-2 $ 个点中选出 $ 2 $ 个点（$ C(n-2, 2) $ 种选择）； 这样计算时，两条“对角线”均为边的情况被计算了两次，需要刨除，相当于先从多边形中选出 $ 1 $ 个边（$ n $ 种选择），再在剩余不相邻的 $ n-3 $ 个边中选出第二边（$ n-3 $ 种选择），并将结果除以 $ 2 $。 故不合法的情况共有 $ n C(n-2, 2) - \\frac{n(n-3)}{2} $ 种。 故合法的情况共有 $ C(n, 4) - n C(n-2, 2) + \\frac{n(n-3)}{2} $ 种。"
  },
  "1.14": {
    "(1)": "\\item 规则可表示为：$ a_1 = 2^0 5^0, a_{60} = 2^{40} 5^{20} $，记 $ a_i = 4^{m_i} 5^{n_i} $，则 $ m_i \\le m_j, n_i \\le n_j, j = i + 1 $。 可以发现 $ m, n $ 两个数列相互独立，分别计算： 数列 $ m $ 可等价为从 $ (2, 0) $ 到 $ (60, 40) $ 的格路问题（$ (1, 0) $ 点只能选择向右），路径数为 $ C(98, 40) $； 数列 $ n $ 可等价为从 $ (2, 0) $ 到 $ (60, 20) $ 的格路问题，路径数为 $ C(78, 20) $。 故共有 $ C(98, 40) C(78, 20) $ 种数列。",
    "(2)": "\\item 类似上一问定义数列 $ m, n $，但规则变为 $ m_i \\le m_j, n_i \\le n_j, m_i + n_i < m_j + n_j, j = i + 1 $。 问题等价为，有红球 $ 40 $ 个，蓝球 $ 20 $ 个，放到 $ 59 $ 个不同盒子中，每个盒子中至少 $ 1 $ 个球。 首先，有且只有 $ 1 $ 个盒子有两个球，该盒子共有 $ 59 $ 种选择； 该盒子可能有三种情况：红球蓝球各 $ 1 $ 个；红球 $ 2 $ 个；蓝球 $ 2 $ 个。 红球蓝球各 $ 1 $ 个时，剩余 $ 58 $ 个球做 $ C(58, 19) $ 的组合； 红球 $ 2 $ 个时，剩余 $ 58 $ 个球做 $ C(58, 20) $ 的组合； 蓝球 $ 2 $ 个时，剩余 $ 58 $ 个球做 $ C(58, 18) $ 的组合。 故共有 $ 59 (C(58, 19) + C(58, 20) + C(58, 18)) $ 种数列。"
  },
  "1.15": {
    "(1)": "首先将 $ 25 $ 个箱子排成一排，共有 $ 25! $ 种排列方式。 在这 $ 25 $ 个箱子中，必然有两个空箱子，首先确定这两个空箱子的位置： 任选两个箱子作为空箱子，共有 $ C(25, 2) $ 中选择，排除其中两个箱子相邻的 $ 24 $ 种情况。 再确定 $ 23 $ 个物体与 $ 23 $ 个箱子的对应关系，即全排列 $ 23! $。 故共有 $ 25!23!(C(25, 2) - 24) $ 个方案。"
  },
  "1.16": {
    "(1)": "\\item 首先，这些直线必定是圆的割线；其次，为了将圆尽可能多地分割，第 $ k $ 条线须与前 $ k-1 $ 条线均相交。 每一次相交，都会将刚刚划过的区域一分为二；而最后与圆周的相交也是如此。故第 $ k $ 条线会引入 $ k $ 个部分。 圆初始有 $ 1 $ 个部分，故 $ n $ 条线会引入 $ 1 + \\sum_1^k k = 1 + \\frac{k(k+1)}{2} $ 个部分。",
    "(2)": "\\item 每 $ 4 $ 个圆周上的点可以连出一个交叉图形，从而唯一确定一个交点，故 $ n $ 条线会引入 $ C(n, 4) $ 个交点。",
    "(3)": "\\item 分类如下： \\begin{enumerate}[(a)] \\item $ 0 $ 个顶点在圆上：构造方法为，从 $ n $ 个点中选择 $ 6 $ 个点，分别向最远点连线。 故共有 $ C(n, 6) $ 种三角形。 \\item $ 1 $ 个顶点在圆上：构造方法为，从 $ n $ 个点中选择 $ 5 $ 个点，并在其中选取 $ 1 $ 个点，从该点向较远的两个点分别连线、剩下两个点连线。 故共有 $ 5 C(n, 5) $ 种三角形。 \\item $ 2 $ 个顶点在圆上：构造方法为，从 $ n $ 个点中选择 $ 4 $ 个点，并在其中选取相邻的 $ 2 $ 个点，连接，再分别向较远的点连线。 故共有 $ 4 C(n, 4) $ 种三角形。 \\item $ 3 $ 个顶点在圆上：构造方法为，从 $ n $ 个点中选择 $ 3 $ 个点，两两相连。 故共有 $ C(n, 3) $ 种三角形。 \\end{enumerate}",
    "(4)": "\\item 圆包含 $ n $ 个弓形和 $ x $ 个“最小多边形”（不能被进一步分割且互不重叠）。 考虑圆内最大的 $ n $ 边形，该 $ n $ 边形每个顶点被 $ n-2 $ 个“最小多边形”共用，内部每个点被 $ 4 $ 个“最小多边形”共用； 该 $ n $ 边形的每个边被 $ 1 $ 个“最小多边形”共用，内部每个线段被 $ 2 $ 个“最小多边形”共用。 内部线段数 $ m $ 满足 $ 2m = 4C(n, 4) + (n-3)n $ （端点计数）。 将这些“最小多边形”的欧拉公式求和，即 $ (n-2)n + 4C(n, 4) + n + 2m - x = x $。 解得 $ x = C(n, 4) + n(n-2) $。 故共有 $ n + x = C(n, 4) + n(n-1) $ 个部分。"
  },
  "1.17": {
    "(1)": "我们可以将 $ V $ 分为两部分：$ V_l = \\{1, 2, \\cdots, n\\}, V_r = \\{n+1, n+2, \\cdots, 2n\\}$，$ V_l $ 和 $ V_r $ 中任意两点之间有连线。 将 $ V_l $ 和 $ V_r $ 分别取 $ k $ 个点排列，按照排列顺序，从两个点集中交替选择简单回路的下一个点，共有 $ P(n, k)P(n, k) $ 种选择。 考虑项链排列，需要将上述方案数除以 $ 2k $。 故共有 $ \\frac{P(n, k)P(n, k)}{2k} $ 种简单回路。"
  },
  "1.18": {
    "(1)": "当最高位为 $ m $、最低位为 $ k $ 时，问题等价为从 $ (2, m) $ 到 $ (n, k) $ 的格路问题，路径数为 $ C(k-m+n-2, n-2) $。 故共有 $ \\sum_{m=1}^9 \\sum_{k=m}^9 C(k-m+n-2, n-2) $ 种方案。"
  },
  "1.19": {
    "(1)": "首先假设所有物品没有个数限制，第一个人可重地拿取共 $ 3n $ 件。 该可重组合数为 $ C(3+3n-1, 3n) = C(3n+2, 2)$。 然后刨去多拿的情况：以拿了 $ 2n + k, 1 \\le k \\le n $ 件甲物品为例， 其组合数相当于从无限多的乙、丙中可重地拿取 $ n - k $ 件，共 $ n - k + 1 $ 中情形（乙的数量从 $ 0 $ 到 $ n - k $）。 故共有 $ C(3n+2, 2) - 3 \\sum_{k=1}^n (n-k+1) = C(3n+2, 2) - \\frac{3n(n+1)}{2} $ 种方案。"
  },
  "1.20": {
    "(1)": "子串 $ c_1c_2 \\cdots c_D $ 的性质保证了两个子串不会部分重叠。 不等式约束表示，当从字符串中选择出 $ k $ 个子串后，不可能再有其他的子串。 那么，可以用新的字符 $ C $ 表示子串，原字符串就变成了字典 $ \\{ c_1, c_2, \\cdots, c_D, C \\} $ 组成的长为 $ n - k(D-1) $ 的字符串。 其中，字符 $ C $ 恰好出现 $ k $ 次，字符 $ c_i $ 出现 $ f_i - k $ 次。 这是一个多重全排列，排列数为 $ P(n-kD+k; k, f_i-k, f_2-k, \\cdots, f_D-k) $。"
  },
  "1.21": {
    "(1)": "\\item 先穿左脚袜子，再穿右脚袜子，再穿左脚鞋子，最后穿右脚鞋子。 每一步有 $ P(100, 100) $ 种排列，共 $ P(100, 100)^4 $ 种方案。 % \\item 将每一对脚的左右鞋、左右袜子看作一组，每组中可以选择左袜-右袜-左鞋-右鞋和左袜-左鞋-右袜-右鞋两种顺序。 % 将 $ 400 $ 个球放入 $ 100 $ 个盒子，每组 $ 4 $ 个球，共有 $ P() P(100, 100) $ 种方案。 % 再将结果乘以 $ 2^{100} $（顺序数），即为本题方案数 $ $。",
    "(2)": "\\item 将每一对脚的左右鞋、左右袜子看作一组，每组内有 $ 24 $ 种排列，但只有左袜-右袜-左鞋-右鞋和左袜-左鞋-右袜-右鞋两种顺序符合要求。 所有 $ 100 $ 组同时满足要求的比例为 $ \\frac{1}{12^{100}} $。 在不考虑顺序要求时，共有 $ P(400, 400) $ 种方案。 故合法方案有 $ \\frac{P(100, 100)}{12^{100}} $ 种。"
  },
  "1.22": {
    "(1)": "$ k_n = \\max k \\text{ s.t. } 2^k | P(2n, n) $ 不易于计算，我们先计算 $ l_n = \\max l \\text{ s.t. } 2^l | P(n, n) $。 由于 $ n $ 可能是任何数，仍不易于计算，先从 $ n = 2^p $ 的情况入手。 对于每个数，其 $ 2 $ 的因子数就等同于该数二进制表示下的后缀 $ 0 $ 的数目。 考虑 $ [1, 2^{p-1}-1] $ 和 $ [2^{p-1}+1, 2^p-1] $ 两段正整数的二进制表示，不难发现，后者中每个数就是在前者对应位置的数上加一个前缀 $ 1 $，这不会影响后缀 $ 0 $ 的数目； 而 $ 2^p $ 的后缀 $ 0 $ 的数目比 $ 2^{p-1} $ 的数目多 $ 1 $。 即 $ l_{2^p} = 2l_{2^{p-1}} + 1 $。等式左右同时加 $ 1 $，有 $ l_{2^p} + 1 = 2(l_{2^{p-1}} + 1) $，得到通项公式 $ l_{2^p} = 2^p - 1 $（初项 $ p=0 $ 时，$ l_1 = 0 $）。 下面考虑 $ n $ 为任意正整数的情况，记 $ n $ 的二进制表示为 $ (b_p\\cdots b_1b_0) $，表示 $ n = \\sum_{i=0}^p b_i 2^i $，其中 $ b_i \\in \\{0, 1\\} $。 将 $ [1, n] $ 中的正整数以 $ (b_p 0\\cdots 0), (b_p b_{p-1} 0\\cdots 0), \\cdots, (b_p \\cdots b_1 0 ) $ 为分界点，分成若干段，分别计算每段中后缀 $ 0 $ 的数目和。 那么，\\[ \\begin{aligned} l_n &= \\sum_{i=0}^p b_i l_{2^i} \\\\ &= \\sum_{i=0}^p b_i(2^i-1) \\\\ &= \\sum_{i=0}^p b_i 2^i - \\sum_{i=0}^p b_i \\\\ &= n - \\sum_{i=0}^p b_i \\end{aligned} \\] 由于 $ P(2n, n) = \\frac{(2n)!}{n!} = \\frac{P(2n, 2n)}{P(n, n)} $，不难发现 $ k_n = l_{2n} - l_n $。 由于 $ 2n $ 的二进制表示为 $ n $ 的二进制表示左移一位，不会增加其中 $ 1 $ 的个数，有 $ \\sum_i b_i^{(2n)} = \\sum_i b_i^{(n)} $。 故 \\[ \\begin{aligned} k_n &= l_{2n} - l_n \\\\ &= (2n - \\sum_i b_i^{(2n)}) - (n - \\sum_i b_i^{(n)}) \\\\ &= n + \\sum_i b_i^{(n)} - \\sum_i b_i^{(2n)} \\\\ &= n \\end{aligned} \\]"
  },
  "1.23": {
    "(1)": "使用反证法。假设存在该进制下的两个数 $ K = (k_1k_2\\cdots k_n ) = L = (l_1l_2\\cdots l_n) $ ，其中，$ K $ 不含前缀 $ 0 $（即 $ k_n \\ge 1 $），但 $ L $ 可以含前缀 $ 0 $。 由于 $ K $ 和 $ L $ 的表示不同，我们选取最高的不同位（第 $ m $ 维），有 $ k_m > l_m $。 这里 $ m \\ge 2 $ 必然成立，否则 $ K $ 和 $ L $ 只有最低位不同，则 $ K-L = m_1-l_1 > 0 $，与假设矛盾。 那么，\\[ \\begin{aligned} K-L &= (k_m-l_m)a_1a_2\\cdots a_{m-1} + \\sum_{i=1}^{m-1} (k_i-l_i)a_1a_2\\cdots a_{i-1} \\\\ &\\ge (k_m-l_m)a_1a_2\\cdots a_{m-1} - \\sum_{i=1}^{m-1} |k_i-l_i|a_1a_2\\cdots a_{i-1} \\\\ &\\ge (k_m-l_m)a_1a_2\\cdots a_{m-1} - \\sum_{i=1}^{m-1} (a_i-1)a_1a_2\\cdots a_{i-1} \\\\ &\\ge a_1a_2\\cdots a_{m-1} - \\sum_{i=1}^{m-1} (a_i-1)a_1a_2\\cdots a_{i-1} \\end{aligned} \\] 简洁起见，我们用 $ A_m = a_1a_2\\cdots a_{m-1} $ 和 $ B_m = \\sum_{i=1}^{m-1} (a_i-1)a_1a_2\\cdots a_{i-1} $ 表示上式中的被减数和减数，即 $ K-L \\ge A_m-B_m $。 下证 $ A_m > B_m (m \\ge 2) $。使用数学归纳法。 当 $ m = 2 $ 时，$ A_2 = a_1 > B_2 = a_1-1 $ 成立。 假设 $ A_{m-1} > B_{m-1} $ 成立，那么 $ B_{m} = B_{m-1} + (a_{m-1}-1)a_1a_2\\cdots a_{m-2} = B_{m-1} + A_m - A_{m-1} < A_m $ 成立。 故 $ A_m > B_m (m \\ge 2) $ 成立。 那么，$ K-L \\ge A_m-B_m > 0 $，这与假设 $ K = L $ 矛盾，故假设不成立。 综上，任意正整数在此进制下的表示唯一。"
  },
  "1.24": {
    "(1)": "首先，任取 $ 4 $ 个点有 $ C(10, 4) $ 种方案。 现在考虑四点共面的情形： 情形一，四点共正四面体的面，即在某一个面的 $ 6 $ 个点中选出了 $ 4 $ 个点，共 $ 4 C(6, 4) $ 种方案； 情形二，三点共线，但四点不共正四面体的面，即选择一条棱的 $ 3 $ 个点后，由选择了对棱中点，共 $ 6 $ 种方案； 情形三，四个点均为中点，共 $ 3 $ 种方案。 故共有 $ C(10, 4) - 4 C(6, 4) - 6 - 3 = 141 $ 种方案。"
  }
}