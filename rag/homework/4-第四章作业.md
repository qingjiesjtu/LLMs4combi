该文件中主要知识点为，利用递推公式的母函数，求解得到通项公式。
# 4.1
设 $G_n = F_{2n} (n \ge 0)$ ，其中 $F_{2n}$ 是第$n$ 个 Fibonacci 数

(1) 证明：$G_n − 3G_{n−1} + G_{n-2} = 0（𝑛 = 2, 3, 4, ⋯）$；
(2) 求数列 $\{G_n\}$ 的母函数



(1) 
$$
\begin{align}
G_n-3G_{n-1}+G_{n-2}&=F_{2n}- 3F_{2n-2}+F_{2n-4}\\
&=F_{2n-1}+F_{2n-2}-3F_{2n-2}+F_{2n-4}\\
&=F_{2n-2}+F_{2n-3}-2F_{2n-2}+F_{2n-4}\\
&=F_{2n-3}+F_{2n-4}-F_{2n-2}\\
&=0
\end{align}
$$
所以第一题得证

(2)
母函数的写法为
$$
G(x)=G_0+G_1x+G_2x^2+\cdots+G_nx^n
$$


已知递推关系为
$$
G_n-3G_{n-1}+G_{n-2}=0
$$
那么列项可以得到：
$$
\begin{align}
G_2-3G_1+G_0&=0\\
G_3x-3G_2x+G_1x&=0\\
G_4x^2-3G_3x^2+G_2x^2&=0\\
\cdots
\end{align}
$$

将多个递推关系进行对应项叠加叠加，可以得到：
$$
\begin{align}
\sum_{i=2}^{n}G_ix^{i-2} -3\sum_{i=1}^{n}G_ix^{i-1} +\sum_{i=0}^{n}G_ix^i&=0\\
x^2\cdot(\sum_{i=2}^{n}G_ix^{i-2} -3\sum_{i=1}^{n}G_ix^{i-1} +\sum_{i=0}^{n}G_ix^i)&=0\\
\sum_{i=2}^{n}G_ix^{i} -3x\sum_{i=1}^{n}G_ix^i +x^2\sum_{i=0}^{n}G_ix^i&=0\\
(G(x)-G_0-G_1x)-3x\cdot (G(x)-G_0) +x^2 G(x)&=0\\
(1-3x+x^2)G(x)&=G_0+G_1x-3G_0x
\end{align}
$$

其中 $G_0=F_0=0,G_1=F_2=1$,带入得到：

$$
G(x)=\frac{x}{1-3x+x^2}
$$

# 4.2
已知数列 $\{a_n\}$ 的母函数为 $\frac{1}{1-x+x^2}$
, 求 $\{a_n\}$ 满足的二阶齐次线性常系数递推式, 并求 $a_0, a_1$.

可得其特征根方程，为 $1-x+x^2=0$, 即对应得二阶齐次线性常系数递推式为
$$
a_n=a_{n-1}-a_{n-2}
$$

下面求首项：
$$
\begin{align}
a_0&=G(x)|_{x=0}=1\\
a_1&=\frac{G(x)-a_0}{x}|_{x=0}=\frac{1-x}{1-x+x^2}|_{x=0}=1
\end{align}
$$


# 4.3
已知 $a_n=c\cdot 3^n +d\cdot (-1)^n,(n\ge 0)$, 
其中 $c,d$ 是常数，求 ${a_n}$ 满足的一个不含 $c,d$ 的线性常系数递推关系。

列出其母函数
$$
\begin{align}
G(x)&=c\sum_{i=0}^{n}(3x)^i +d\sum_{i=0}^{n}(-x)^i\\
&=c\times \frac{1}{1-3x}+d \times \frac{1}{1+x}\\
&=\frac{c(1+x)+d(1-3x)}{(1-3x)(1+x)}\\
&=\frac{c(1+x)+d(1-3x)}{1-2x-3x^2}
\end{align}
$$

所以一个递推关系式为：

$$
a_n-2a_{n-1}-3a_{n-2}=0
$$

# 4.4
求解递推关系：
$$\begin{cases}&a_n-2a_{n-1}+a_{n-2}=5\quad(n\geq2)\\&a_0=1,\:a_1=2\end{cases}$$

先转化为线性常系数递推关系
$$
\begin{align}
a_n-2a_{n-1}+a_{n-2}=5\\
a_{n-1}-2a_{n-2}+a_{n-3}=5\\
a_n-3a_{n-1}+3a_{n-2}-a_{n-3}=0
\end{align}
$$

那么对应的特征多项式为：
$$
C(x)=x^3-3x^2+3x-1=(x-1)^3
$$

有特征根 1 为3重根，那么 $m=1, k_1=3$ 代入公式：

$$
a_n=\sum_{i=1}^m\sum_{j=1}^{k_i}A_{ij}\binom{n+j-1}n\alpha_i^n
$$

$$
\begin{align}
a_n&=A_{11}C_{n}^{n}\cdot 1^n+A_{12}C^{n}_{n+1}\cdot 1^n+A_{13}C_{n+2}^{n}\cdot 1^n\\
&=A_{11}+A_{12}(n+1)+A_{13}\frac{(n+2)(n+1)}{2}
\end{align}
$$

现计算初值，$a_2=5-+2a_1-a_0=8$

带入上式可以计算得出：
$$
a_n=5-9(n+1)+5\times \frac{n^2+3n+2}{2}=\frac{5}{2}-\frac{3}{2}n+1
$$

# 4.5
由 $A,B,C,D$ 四个字母组成允许重复的 $n$ 位字符串，其中子串 $AB$ 至少出现一次，求
满足要求的字符串数目.

假设满足字符串要求的字符串为 $a_n$. 和前串的关系为，假如前 $n-1$ 个字符中存在 $AB$ 那么最后一位可任取一个字母，这种情况可以表示为: $4a_{n-1}$。 假如 $AB$ 在最后才出现，且前面没有出现过，那么这种情况应该为 $4^{n-2}-a_{n-2}$.

因此，有递推关系: $a_n-4a_{n-1}+a_{n-2}=4^{n-2}$.

易知 $a_1=0, a_2=1$, 那么 $a_0=0$。

将递推关系式进行做差

$$
\begin{align}
a_n-4a_{n-1}+a_{n-2}-4(a_{n-1}-4a_{n-2}+a_{n-3})&=0\\
a_n-8a_{n-1}+17a_{n-2}-4a_{n-3}&=0
\end{align}
$$

那么特征多项式及其分解为：

$$
\begin{align}
C(x)&=x^3-8x^2+17x-4\\
&=(x-4)(x^2-4x+1)
\end{align}
$$

```
上式一定能分解出来 (x-4) 的原因是，做差时乘了倍数4。
```
那么特征根为$\alpha_1=4,\alpha_2=2+\sqrt{3},\alpha_3=2-\sqrt(3)$

那么对应的通项公式为

$$
a_n=A4^n+B(2+\sqrt{3})^n+C(2-\sqrt{3})^n
$$
将前几项代入求解得到：
$$
a_n=4^n-\frac{\sqrt{3}}{6}(2+\sqrt{3})^n+\frac{\sqrt{3}}{6}(2-\sqrt{3})^n
$$


# 4.6
考虑如下汉诺塔问题的变种：有 $A,B,C$ 三根柱子，初始时 $A$ 柱上有 $n$ 个圆盘，按直径从小到大的顺序编号为 1 到 $n$; 最终目标是将所有偶数编号的盘套在 $B$ 柱上、所有奇数编号的盘套在 $C$ 柱上.移动圆盘时的规则不变，求所需的最小移动次数.

第一步，需要将第n个盘放在对应的柱上（这里可以不考虑n的奇偶），相当于把n-1个盘移动到另一个柱子上，再移动剩下的一个。同时（n-1）会因为这个移动自动到对应的柱上，该步的操作数为：

$H(n-1)+1=2^{n-1}$

第二步之需要移动 n-3 个盘，对应的次数为 $2^{n-3}$

此时开始循环操作，因此得到递推式。

$$
a_n=2^{n-1}+2^{n-3}+a_{n-3}
$$

做差得到
$$
a_n-2a_{n-1}-a_{n-3}+2a_{n-4}=0
$$

列出特征方程，并求解得到：
$$
x^4-2x^3-x+2=0,x=1,2,\frac{-1-\sqrt{3}}{2},\frac{-1+\sqrt{3}}{2}
$$

那么得到表达式
$$
a_n=A_1+A_2 2^n+A_3 cos\frac{2n\pi}{3} +A_4 sin\frac{2n\pi}{3}
$$

将首项代入，可以得到：
$$
a_n=-\frac{2}{3}+\frac{5}{7}2^n-\frac{1}{21}cos\frac{2n\pi}{3} + \frac{\sqrt3}{7}sin\frac{2n\pi}{3}
$$

# 4.7
使用 $k$ 种字母组成长度为 $n$ 的字符串，但不允许相同字母连续出现 3 次，求方案数.

解：
<!-- 假设长度为 $n$ 的存在相同字母出现三次的个数为 $b_n$ , 那么满足题意的表达式为：
$$
a_n=k^n-b_n
$$
不好求 -->
及最多重复2个字符。设符合要求的字符串有$a_n$个，最后两个字符不同的$b_n$个，那么
1. 倒数前两个字符不同，直接乘k
2. 前两个字符相同，那么乘 k-1
3. $n$个字符的字符串，最后两个字符不同的情况有 $(k-1)a_{n-1}$个。

$$a_n=k(k-2)a_{n-2}+(k-1)(a_{n-1}-(k-2)a_{n-2})$$

$$a_n=(k-1)a_{n-1}+(k-1)a_{n-2}$$

$$x^2-(k-1)x-(k-1)=0$$

$$x=\frac{k-1\pm\sqrt{(k-1)(k+3)}}2$$


结合初项为$a_1=k,a_2=k^2$，所以$\{a_n\}$的通项为

$$
a_{n}=\frac{k\left(\sqrt{k+3}+\sqrt{k-1}\right)}{2(k-1)\sqrt{k+3}}\left(\frac{k-1+\sqrt{(k-1)(k+3)}}2\right)^n+\frac{k\left(\sqrt{k+3}-\sqrt{k-1}\right)}{2(k-1)\sqrt{k+3}}\left(\frac{k-1-\sqrt{(k-1)(k+3)}}2\right)^n
$$




# 4.8
计算：$\sum_{k=1}^nk^4$.

$$
\begin{align}
S_{n}^{(4)}&=\sum_{k=1}^nk^4\\
S_{n}^{(4)}&=S_{n-1}^{(4)}+n^4\\
\end{align}
$$

不断地错位求差
$$
\begin{align}
S_{n}^{(4)}-S_{n-1}^{(4)}&=S_{n-1}^{(4)}-S_{n-2}^{(4)}+n^4-(n-1)^4\\
&=S_{n-1}^{(4)}-S_{n-2}^{(4)}+4n^3-6n^2+4n-1\\
S_{n}^{(4)}-2S_{n-1}^{(4)}+S_{n-2}^{(4)}&=4n^3-6n^2+4n-1
\end{align}
$$

$$
\begin{align}
S_{n}^{(4)}-2S_{n-1}^{(4)}+S_{n-2}^{(4)}&=4n^3-6n^2+4n-1\\
S_{n-1}^{(4)}-2S_{n-2}^{(4)}+S_{n-3}^{(4)}&=4(n-1)^3-6(n-1)^2+4(n-1)-1\\
&=4n^3-18n^2+28n-15\\
S_{n}^{(4)}-3S_{n-1}^{(4)}+3S_{n-2}^{(4)}-S_{n-3}^{(4)}&=12n^2-24n+14
\end{align}
$$

$$
\begin{align}
S_n^{(4)}-4S_{n-1}^{(4)}+6S_{n-2}^{(4)}-4S_{n-3}^{(4)}+S_{n-4}^{(4)}&=12n^2-24n+14-(12n^2-24n+14)|_{n=n-1}\\
&=24n-36
\end{align}
$$

$$
\begin{align}
S_n^{(4)}-5S_{n-1}^{(4)}+10S_{n-2}^{(4)}-10S_{n-3}^{(4)}+5S_{n-4}^{(4)}-S_{n-5}^{(4)}&=24n-36-24n+24+36\\
&=24
\end{align}
$$

$$
\begin{align}
S_n^{(4)}-6S_{n-1}^{(4)}+15S_{n-2}^{(4)}-20S_{n-3}^{(4)}+15S_{n-4}^{(4)}-6S_{n-5}^{(4)}+S_{n-6}^{(4)}=0
\end{align}
$$

计算开始的数值：
$$
S_0^{(4)}=0,S_1^{(4)}=1,S_2^{(4)}=17,S_3^{(4)}=98,S_4^{(4)}=354,S_5^{(4)}=979
$$

特征根方程在做差中知道1是其一个特征根，求解后发现是6重根，所以递推公式形式为：
$$
\begin{align}
S_n^{(4)}&=An^5+Bn^4+Cn^3+Dn^2+En+F\\
&=\frac{n^5}{5}+\frac{n^4}{2}+\frac{n^3}{3}-\frac{n}{30}
\end{align}
$$

# 4.9
从 1 到 $n$ 的正整数中选取 $k$ 个不同且不相邻的数，方案数记为 $f(n,k)$ 
(1) 求 $f(n,k)$ 满足的一个线性常系数递推关系；
(2) 用数学归纳法求 $f(n,k)$ 的通项表示；
(3) 若规定 1 与 $n$ 是相邻的数，并在此前提下令从 1 到 $n$ 的正整数中选取 $k$ 个不同且不相邻的数的方案数为 $g(n,k)$ ,利用 $f(n,k)$ 求 $g(n,k)$.

解：
(1) 如果选择n， 则n-1一定不能被选择， 那么相当于从前n-2个数中选k-1个不相邻的数，即 $f(n-1,k)$.
若不选择n，则相当于从前 n-1 个数中选k个不相邻的数，方案个数为 $f(n-2,k-1)$.

即
$$
f(n,k)=f(n-1,k)+f(n-2,k-1)
$$

(2)
n=1, f(1,0)=1, f(1,1)=1
n=2, f(2,0)=1, f(2,1)=2
n=3, f(3,0)=1, f(3,1)=3, f(3,2)=1
n=4, f(4,0)=1, f(4,1)=4, f(4,2)=3
n=5, f(5,0)=1, f(5,1)=5, f(5,2)=6

和杨辉三角中每一行很像，但是又不同，将杨辉三角列出
$$
\begin{align}
&1\\
&1,1\\
&1,2,1\\
&1,3,3,1\\
&1,4,6,4,1\\
&1,5,10,10,5,1
\end{align}
$$

用绘图更容易看出对应关系

![](./assets/show1119.png)

即数学归纳法能得到数值为：
$$
f(n,k)=C^{k}_{n-k+1},(2k-1\le n)
$$

下面进行证明任意一个$n_i>5$,该式都成立：
$$
\begin{align}
f(n_i,k)&=f(n_i-1,k)+f(n_i-2,k-1)\\
&=C^{k}_{n_i-1-k+1}+C^{k}_{n_i-2-k+1+1}\\
&=C^{k}_{n_i-k}+C^{k-1}_{n_i-k}\\
&=C^{k}_{n_i-k+1}, (2k-1\le n_i)
\end{align}
$$

得证

(3)
若没选1，则剩下和（1）情况相同，即在2～n中选k个。
即若选了1，不能选2和n，剩下和（1）相同，即在3～(n-1)中选k-1个。

所以，
$$
g(n,k)=f(n-1,k)+f(n-3,k-1)=C^{k}_{n-k}+C^{k-1}_{n-k-1}, 2k\le n
$$


# 4.10
使用尺寸为  $1\times 1$ 的方砖、直角边长为 1 的等腰直角三角形砖，以及斜边长为 2 的等
腰直角三角形砖，铺设 $1\times n$ 的路径，求：
(1) 所有可能的铺砖方案数；
(2) 每一种可能的铺砖方案中使用的砖数相加，得到的砖数的总和.

解：
(1)设定方案数为$a_n$。
易知：$a_1=3$
1. 若最后一个为方砖，那么方案数和 $a_{n-1}$ 相同。
2. 如果最后一块砖为直角边为1的三角砖，那么一定同样存在一个直角边为1的三角砖在前方呼应。这两个砖块之间不能出现方砖，因为出现方砖就变能够直接由$a_k$表示，不需要讨论。 即三角砖中间可以有任意可能数量的斜边为2的三角砖。 那么假设共有k个三角砖，那么方案数为： $2a_{n-k+1},2\le k\le n+1$.

所以方案数的递推关系为：
$$
\begin{align}
a_n&=a_{n-1}+2\sum^{n-1}_{i=0}a_i\\
a_n&=a_{n-1}+2a_{n-1}+2a_{n-2}+\cdots+2a_{1}+2a_0
\end{align}
$$
可以计算得到 $a_0=1$
从而不停做差得到：
$$
\begin{align}
a_n&=a_{n-1}+2a_{n-1}+2a_{n-2}+\cdots+2a_{1}+2a_0\\
a_{n-1}&=a_{n-2}+2a_{n-2}+2a_{n-3}+\cdots+2a_0\\
a_{n}-a_{n-1}&=3a_{n-1}-a_{n-2}\\
a_n&=4a_{n-1}-a_{n-2}
\end{align}
$$

从而可以解出通项
$$
a_n=\frac{(3+\sqrt{3})(2+\sqrt{3})^n+(3-\sqrt{3})(2-\sqrt{3})^n}{6}
$$

(2)设砖数的总和为$S_n$。

1. 最后为方砖，则此总砖数为
$S_{n-1}+a_{n-1},n\ge 2$
2. 和（1）中相同的情况，方砖数为：
$2(S_{n-k+1}+2ka_{n-k+1}),2\le k\le n+1$

所以递推关系为：
$$
\begin{align}
S_n&=S_{n-1}+a_{n-1}+2\sum^{n}_{k=2} (S_{n-k+1}+ka_{n-k+1})\\
&=S_{n-1}+a_{n-1}+2(S_{n-1}+2a_{n-1})+2(S_{n-2}+3a_{n-2})+\cdots\\
S_{n-1}&=S_{n-2}+a_{n-2}+2(S_{n-2}+2a_{n-2})+2(S_{n-3}+3a_{n-3})+\cdots\\
S_{n}-S_{n-1}&=S_{n-1}-S_{n-2}+a_{n-1}-a_{n-2}+2(S_{n-1}+2a_{n-1})+2a_{n-2}+2a_{n-3}+\cdots\\
&\cdots （太多了，，，，）\\
S_n-9S_{n-1}&+26S_{n-2}-26S_{n-3}+9S_{n-4}-S_{n-5}=0
\end{align}
$$
那么特征方程在逐差过程中得到有一个特征根1：
$$
(x-1)(x^2-4x+1)^2
$$

特征根为 $\alpha_1=1，\alpha_2=\alpha_3=2+\sqrt{3}, \alpha_4=\alpha_5=2-\sqrt{3}$
初项为：
$$
b_0=0,b_1=5,b_2=36,b_3=199,b_4=984
$$

那么计算得到通项公式为：
$$
S_n=(\frac{12n+(6n+1)\sqrt{3}}{18})(2+\sqrt{3})^n+(\frac{12n-(1+6n)\sqrt{3}}{18})(2-\sqrt{3})^n
$$