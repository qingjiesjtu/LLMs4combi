# 特征多项式实际上表达的是母函数的部分分式形式

# 4.5
由 $A,B,C,D$ 四个字母组成允许重复的 $n$ 位字符串，其中子串 $AB$ 至少出现一次，求
满足要求的字符串数目.

假设满足字符串要求的字符串为 $a_n$. 和前串的关系为，假如前 $n-1$ 个字符中存在 $AB$ 那么最后一位可任取一个字母，这种情况可以表示为: $4a_{n-1}$。 假如 $AB$ 在最后才出现，且前面没有出现过，那么这种情况应该为 $4^{n-2}-a_{n-2}$.

因此，有递推关系: $a_n-4a_{n-1}+a_{n-2}=4^{n-2}$.

易知 $a_1=0, a_2=1$, 那么 $a_0=0$。

将递推关系式进行做差

$$
\begin{align}
a_n-4a_{n-1}+a_{n-2}-4(a_{n-1}-4a_{n-2}+a_{n-3})&=0\\
a_n-8a_{n-1}+17a_{n-2}-4a_{n-3}&=0
\end{align}
$$

那么特征多项式及其分解为：

$$
\begin{align}
C(x)&=x^3-8x^2+17x-4\\
&=(x-4)(x^2-4x+1)
\end{align}
$$

```
上式一定能分解出来 (x-4) 的原因是，做差时 乘了倍数4。
```

其实可以这样理解：
$a_n-4a_{n-1}+a_{n-2}=0$的特征多项式表示为
$$
C'(x)=x^2-4x+1
$$

那么上面做差的过程，实际上和 $C'(x)\cdot (x-4)$ 是相对应的。
所以 $a_n-4a_{n-1}+a_{n-2}=4^{n-2}$ 形式的递推关系，可以直接由左侧的特征根和右侧幂数共同组成。